services:
  - type: web
    name: combined-website-analyzer
    runtime: docker
    plan: starter  # Can upgrade to standard/pro for better performance
    region: oregon  # or: frankfurt, singapore, ohio
    branch: main
    dockerfilePath: ./Dockerfile
    dockerContext: ./
    
    # Environment variables
    envVars:
      - key: PYTHONPATH
        value: /app
      - key: ENVIRONMENT
        value: production
      - key: API_VERSION
        value: "4.1.0"
      - key: MAX_WORKERS
        value: "1"
      - key: TIMEOUT_SECONDS
        value: "300"
      - key: PLAYWRIGHT_BROWSERS_PATH
        value: /ms-playwright
      # Google API Keys - ADD THESE VIA RENDER DASHBOARD (NOT HERE!)
      # - key: PSI_API_KEY
      #   value: YOUR_PAGESPEED_INSIGHTS_API_KEY
      # - key: CRUX_API_KEY  
      #   value: YOUR_CHROME_UX_REPORT_API_KEY
    
    # Health check endpoint
    healthCheckPath: /health
    
    # Auto-deploy settings
    autoDeploy: true
    
    # Build settings
    buildFilter:
      paths:
      - main.py
      - requirements.txt
      - Dockerfile
      - render.yaml
      - .env

# Optional: Add a Redis cache for caching analysis results (requires paid plan)
# - type: redis
#   name: analyzer-cache
#   plan: starter
#   maxmemoryPolicy: allkeys-lru
